<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜éšé›™çµ„ä»½ç’°æ°§é…æ–¹è¨ˆç®—æ©Ÿ</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --bg-color: #f1f5f9;
            --card-bg: #ffffff;
            --text-color: #0f172a;
            --border-color: #cbd5e1;
            --input-bg: #ffffff;
            --success-color: #16a34a;
            --danger-color: #dc2626;
        }

        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 25px;
            font-weight: 800;
        }

        /* --- å¡ç‰‡å®¹å™¨ --- */
        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
        }

        .card-header {
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 0;
        }

        /* --- è¼¸å…¥è¡Œå€å¡Š (Row) --- */
        .input-row {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
        }

        /* è¼¸å…¥æ¬„ä½ç¾¤çµ„ (Grid) */
        .fields-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            align-items: start;
        }

        .field-group {
            display: flex;
            flex-direction: column;
        }

        .field-label {
            font-size: 0.9rem;
            font-weight: bold;
            color: #475569;
            margin-bottom: 5px;
        }

        /* --- è¼¸å…¥æ¡†æ¨£å¼ --- */
        input[type="text"],
        input[type="number"],
        select {
            padding: 10px;
            border: 1px solid #94a3b8;
            border-radius: 6px;
            background-color: var(--input-bg);
            color: #000000;
            font-size: 1rem;
            width: 100%;
            box-sizing: border-box;
        }

        input:focus, select:focus {
            outline: 2px solid var(--primary-color);
            border-color: var(--primary-color);
        }

        /* éš±è—æ•¸å­—ä¸Šä¸‹ç®­é ­ */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }

        /* --- çµæœé¡¯ç¤ºæ–‡å­— (å°) --- */
        .calc-display {
            font-size: 0.9rem;
            color: var(--primary-color);
            font-weight: bold;
            margin-top: 5px;
        }

        /* --- æŒ‰éˆ• --- */
        .btn {
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: 0.2s;
            width: 100%;
        }

        .btn-add {
            background-color: var(--success-color);
            color: white;
            margin-top: 10px;
        }
        .btn-add:hover { background-color: #15803d; }

        .btn-remove {
            background-color: #fee2e2;
            color: var(--danger-color);
            margin-top: 10px;
            padding: 8px;
        }
        .btn-remove:hover { background-color: #fecaca; }

        /* --- å…¨åŸŸè¨­å®š (è¨ˆé‡æ¯”) --- */
        .global-settings {
            background-color: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        /* --- çµæœå€ (ç§»åˆ°å¡ç‰‡å…§) --- */
        .result-box {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.2);
        }

        .result-main {
            font-size: 2.2rem;
            font-weight: 800;
            margin: 5px 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .result-sub {
            background-color: rgba(255,255,255,0.15);
            padding: 8px 15px;
            border-radius: 6px;
            display: inline-block;
            margin-top: 10px;
            font-size: 1.1rem;
        }

        /* --- å°ˆå®¶å»ºè­°å€ --- */
        .expert-box {
            background-color: #f0fdf4;
            border-left: 6px solid var(--success-color);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
        }

        .expert-title {
            color: #166534;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 15px;
            border-bottom: 1px dashed #bbf7d0;
            padding-bottom: 10px;
        }

        /* --- è¨ˆç®—éç¨‹å€ --- */
        .breakdown-box {
            background-color: #f8fafc;
            border: 1px solid #cbd5e1;
            padding: 20px;
            border-radius: 8px;
            font-family: Consolas, monospace;
            color: #334155;
            font-size: 0.95rem;
        }

    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ§ª é«˜éšé›™çµ„ä»½ç’°æ°§é…æ–¹è¨ˆç®—æ©Ÿ</h1>

    <div class="card">
        <div class="card-header">
            <span class="card-title">A åŠ‘ - æ¨¹è„‚ (Resin)</span>
        </div>
        <div id="resin-container">
            </div>
        <button class="btn btn-add" onclick="addResinRow()">+ æ–°å¢æ¨¹è„‚ (Add Resin)</button>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="card-title">B åŠ‘ - ç¡¬åŒ–åŠ‘ (Hardener)</span>
        </div>
        <div id="hardener-container">
            </div>
        <button class="btn btn-add" onclick="addHardenerRow()">+ æ–°å¢ç¡¬åŒ–åŠ‘ (Add Hardener)</button>

        <div class="global-settings">
            <div class="field-group">
                <label for="stoichiometry" class="field-label" style="font-size: 1rem;">åŒ–å­¸è¨ˆé‡æ¯” (Stoichiometry):</label>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <input type="number" id="stoichiometry" value="1.0" step="0.05" style="width: 120px; font-weight: bold;">
                    <span style="color: #64748b; font-size: 0.9rem;">(é è¨­ 1.0ï¼Œ>1 ç‚ºèƒºéé‡)</span>
                </div>
            </div>
        </div>

        <div class="result-box">
            <div style="opacity: 0.9; font-size: 0.9rem;">å»ºè­°é…æ¯” (PHR - å¯¦é©—å®¤æ¨™æº–)</div>
            <div class="result-main" id="result-phr">100 : --</div>
            
            <div class="result-sub">
                <div style="opacity: 0.9; font-size: 0.8rem; margin-bottom: 2px;">ç¾å ´æ–½å·¥æ¯”ä¾‹ (é‡é‡æ¯”)</div>
                <div id="result-ratio" style="font-weight: bold;">-- : 1</div>
            </div>
        </div>
    </div>

    <div class="expert-box">
        <div class="expert-title">âš—ï¸ å°ˆå®¶é…æ–¹åˆ†æèˆ‡å»ºè­° (Expert Analysis)</div>
        <div id="expert-advice-content">
            è«‹è¼¸å…¥æ¨¹è„‚èˆ‡ç¡¬åŒ–åŠ‘æ•¸æ“šä»¥å–å¾—åˆ†æå ±å‘Š...
        </div>
    </div>

    <div class="breakdown-box">
        <div style="font-weight: bold; margin-bottom: 10px; color: #475569; border-bottom: 1px dashed #94a3b8; padding-bottom:5px;">
            ğŸ”¢ è©³ç´°è¨ˆç®—éç¨‹ (Calculation Breakdown)
        </div>
        <div id="math-breakdown">
            ç­‰å¾…æ•¸æ“šè¼¸å…¥...
        </div>
    </div>
</div>

<script>
    // --- ç‹€æ…‹ç®¡ç† ---
    let resinCount = 0;
    let hardenerCount = 0;

    // --- ç¶²é è¼‰å…¥æ™‚åŸ·è¡Œ ---
    document.addEventListener('DOMContentLoaded', () => {
        addResinRow(); 
        addHardenerRow();
        
        // ç›£è½è¨ˆé‡æ¯”è¼¸å…¥
        const stoichInput = document.getElementById('stoichiometry');
        if(stoichInput) {
            stoichInput.addEventListener('input', calculateAll);
        }
    });

    // --- ç”¢ç”Ÿè¼¸å…¥æ¡† HTML ---
    function createResinRowHTML(index) {
        return `
            <div class="input-row" id="resin-row-${index}">
                <div class="fields-grid">
                    <div class="field-group" style="flex: 2;">
                        <label class="field-label">æ¨¹è„‚åç¨±</label>
                        <input type="text" placeholder="ä¾‹å¦‚: YD-128" class="calc-input">
                    </div>
                    <div class="field-group">
                        <label class="field-label">é‡é‡å æ¯” (%)</label>
                        <input type="number" class="calc-input resin-wt" placeholder="100" value="${index===1 ? 100 : ''}">
                    </div>
                    <div class="field-group">
                        <label class="field-label">å›ºå«é‡ (NV%)</label>
                        <input type="number" class="calc-input resin-nv" placeholder="ä¾‹å¦‚: 100">
                    </div>
                    <div class="field-group">
                        <label class="field-label">è¼¸å…¥ç’°æ°§ç•¶é‡</label>
                        <input type="number" class="calc-input resin-eew" placeholder="ä¾‹å¦‚: 188">
                    </div>
                    <div class="field-group" style="flex: 1.5;">
                        <label class="field-label">ç•¶é‡åŸºæº–</label>
                        <select class="calc-input resin-toggle">
                            <option value="solid">å›ºé«” (éœ€æ›ç®—)</option>
                            <option value="solution" selected>åŸæ¶²/æ¶²é«” (TDSå€¼)</option>
                        </select>
                        <div class="calc-display" id="resin-display-${index}">-> æº¶æ¶²EEW: --</div>
                    </div>
                </div>
                ${index > 1 ? `<button class="btn btn-remove" onclick="removeRow('resin-row-${index}')">åˆªé™¤æ­¤è¡Œ</button>` : ''}
            </div>
        `;
    }

    function createHardenerRowHTML(index) {
        return `
            <div class="input-row" id="hardener-row-${index}">
                <div class="fields-grid">
                    <div class="field-group" style="flex: 2;">
                        <label class="field-label">ç¡¬åŒ–åŠ‘åç¨±</label>
                        <input type="text" placeholder="ä¾‹å¦‚: G-5022" class="calc-input">
                    </div>
                    <div class="field-group">
                        <label class="field-label">é‡é‡å æ¯” (%)</label>
                        <input type="number" class="calc-input hardener-wt" placeholder="100" value="${index===1 ? 100 : ''}">
                    </div>
                    <div class="field-group">
                        <label class="field-label">åŸæ¶²æ´»æ½‘æ°«ç•¶é‡</label>
                        <input type="number" class="calc-input hardener-ahew" placeholder="ä¾‹å¦‚: 95">
                    </div>
                    <div class="field-group">
                        <label class="field-label">ç¨€é‡‹å¾Œæ¿ƒåº¦ (%)</label>
                        <input type="number" class="calc-input hardener-conc" placeholder="é è¨­ 100" value="100">
                        <div class="calc-display" id="hardener-display-${index}">-> æœ‰æ•ˆAHEW: --</div>
                    </div>
                </div>
                ${index > 1 ? `<button class="btn btn-remove" onclick="removeRow('hardener-row-${index}')">åˆªé™¤æ­¤è¡Œ</button>` : ''}
            </div>
        `;
    }

    // --- æ–°å¢/åˆªé™¤é‚è¼¯ ---
    function addResinRow() {
        if(resinCount >= 5) return; 
        resinCount++;
        const container = document.getElementById('resin-container');
        if(container) {
            container.insertAdjacentHTML('beforeend', createResinRowHTML(resinCount));
            bindEvents(); 
        }
    }

    function addHardenerRow() {
        if(hardenerCount >= 3) return; 
        hardenerCount++;
        const container = document.getElementById('hardener-container');
        if(container) {
            container.insertAdjacentHTML('beforeend', createHardenerRowHTML(hardenerCount));
            bindEvents();
        }
    }

    function removeRow(id) {
        const el = document.getElementById(id);
        if(el) {
            el.remove();
            calculateAll();
        }
    }

    function bindEvents() {
        const inputs = document.querySelectorAll('.calc-input');
        inputs.forEach(input => {
            input.removeEventListener('input', calculateAll); 
            input.addEventListener('input', calculateAll);
        });
    }

    // --- æ ¸å¿ƒè¨ˆç®—é‚è¼¯ (NV=0 ä¿®æ­£ç‰ˆ) ---
    function calculateAll() {
        // 1. è¨ˆç®— A åŠ‘
        let totalEqA = 0;
        let breakdownA = "";
        let solidEEWSum = 0; 
        let totalResinWt = 0;

        const resinRows = document.querySelectorAll('[id^="resin-row-"]');
        resinRows.forEach(row => {
            const wt = parseFloat(row.querySelector('.resin-wt').value) || 0;
            
            // ä¿®æ­£ï¼šå€åˆ†ç©ºå€¼èˆ‡0
            const nvStr = row.querySelector('.resin-nv').value;
            const nv = nvStr === "" ? 100 : parseFloat(nvStr);

            // å³ä½¿ NV=0ï¼Œä¹Ÿå…è¨±è®€å– inputEEW
            const inputEEW = parseFloat(row.querySelector('.resin-eew').value) || 0;
            const toggle = row.querySelector('.resin-toggle').value;
            const displaySpan = row.querySelector('[id^="resin-display-"]');
            
            totalResinWt += wt;

            // ç‰¹æ®Šæƒ…æ³ï¼šå›ºå«ç‚º 0 (æº¶åŠ‘)
            if (nv === 0) {
                // é¡¯ç¤ºç‚º 0 (ä¸åƒèˆ‡åæ‡‰)
                displaySpan.textContent = `-> æº¶æ¶²EEW: 0.0 (æº¶åŠ‘)`;
                displaySpan.style.color = "#64748b"; // ç°è‰²å­—é«”

                // ä¸åƒèˆ‡ç•¶é‡è¨ˆç®— (è²¢ç»ç‚º 0)
                const contribution = 0;
                // EEW ç•¶ä½œç„¡é™å¤§ï¼Œä¸åŠ å…¥è¨ˆç®—
                
                breakdownA += `<div style="margin-bottom:4px; color:#64748b;">æ¨¹è„‚(æº¶åŠ‘): ${wt}% Ã· ç„¡é™å¤§ = <b>0.0000</b></div>`;
            } 
            else if (inputEEW > 0) {
                // æ­£å¸¸è¨ˆç®—
                displaySpan.style.color = "var(--primary-color)"; // æ¢å¾©è—è‰²
                
                let effectiveEEW;
                let solidEEW;

                if (toggle === 'solid') {
                    effectiveEEW = inputEEW / (nv / 100);
                    solidEEW = inputEEW;
                } else {
                    effectiveEEW = inputEEW;
                    solidEEW = inputEEW * (nv / 100);
                }

                displaySpan.textContent = `-> æº¶æ¶²EEW: ${effectiveEEW.toFixed(1)}`;

                const contribution = wt / effectiveEEW;
                totalEqA += contribution;
                solidEEWSum += (wt * solidEEW);

                breakdownA += `<div style="margin-bottom:4px;">æ¨¹è„‚: ${wt}% Ã· ${effectiveEEW.toFixed(1)} = <b>${contribution.toFixed(4)}</b></div>`;
            } else {
                displaySpan.textContent = "-> æº¶æ¶²EEW: --";
            }
        });

        // 2. è¨ˆç®— B åŠ‘
        let totalEqB = 0;
        let breakdownB = "";
        let ahewSum = 0; 
        let totalHardenerWt = 0;

        const hardenerRows = document.querySelectorAll('[id^="hardener-row-"]');
        hardenerRows.forEach(row => {
            const wt = parseFloat(row.querySelector('.hardener-wt').value) || 0;
            const inputAHEW = parseFloat(row.querySelector('.hardener-ahew').value) || 0;
            
            // ä¿®æ­£ï¼šå€åˆ†ç©ºå€¼èˆ‡0
            const concStr = row.querySelector('.hardener-conc').value;
            const conc = concStr === "" ? 100 : parseFloat(concStr);

            const displaySpan = row.querySelector('[id^="hardener-display-"]');

            totalHardenerWt += wt;

            if (conc === 0) {
                // æ¿ƒåº¦ç‚º0ï¼Œè¦–ç‚ºæº¶åŠ‘
                displaySpan.textContent = `-> æœ‰æ•ˆAHEW: 0.0 (æº¶åŠ‘)`;
                displaySpan.style.color = "#64748b";
                breakdownB += `<div style="margin-bottom:4px; color:#64748b;">ç¡¬åŒ–åŠ‘(æº¶åŠ‘): ${wt}% Ã· ç„¡é™å¤§ = <b>0.0000</b></div>`;
            }
            else if (inputAHEW > 0) {
                displaySpan.style.color = "var(--primary-color)";
                const effectiveAHEW = inputAHEW / (conc / 100);
                displaySpan.textContent = `-> æœ‰æ•ˆAHEW: ${effectiveAHEW.toFixed(1)}`;

                const contribution = wt / effectiveAHEW;
                totalEqB += contribution;
                ahewSum += (wt * inputAHEW);

                breakdownB += `<div style="margin-bottom:4px;">ç¡¬åŒ–åŠ‘: ${wt}% Ã· ${effectiveAHEW.toFixed(1)} = <b>${contribution.toFixed(4)}</b></div>`;
            } else {
                displaySpan.textContent = "-> æœ‰æ•ˆ: --";
            }
        });

        // 3. æ··åˆåƒæ•¸
        const finalEEW_A = totalEqA > 0 ? (100 / totalEqA) : 0;
        const finalAHEW_B = totalEqB > 0 ? (100 / totalEqB) : 0;
        const stoichiometry = parseFloat(document.getElementById('stoichiometry').value) || 1.0;

        // 4. æ›´æ–°è¨ˆç®—éç¨‹
        let breakdownHTML = `<div style="margin-bottom:15px;"><strong>1. A åŠ‘ (æ¨¹è„‚) æ··åˆé‹ç®—</strong><br>${breakdownA}`;
        if(totalEqA > 0) {
             breakdownHTML += `A åŠ‘ç¸½ç•¶é‡æ•¸ (Total Eq) = <b>${totalEqA.toFixed(4)}</b><br>`;
             breakdownHTML += `A åŠ‘æ··åˆ EEW = 100 Ã· ${totalEqA.toFixed(4)} = <span style="color:#2563eb"><b>${finalEEW_A.toFixed(2)}</b></span></div>`;
        } else {
            breakdownHTML += `(ç­‰å¾…æ•¸æ“š...)</div>`;
        }

        breakdownHTML += `<div style="margin-bottom:15px;"><strong>2. B åŠ‘ (ç¡¬åŒ–åŠ‘) æ··åˆé‹ç®—</strong><br>${breakdownB}`;
        if(totalEqB > 0) {
             breakdownHTML += `B åŠ‘ç¸½ç•¶é‡æ•¸ (Total Eq) = <b>${totalEqB.toFixed(4)}</b><br>`;
             breakdownHTML += `B åŠ‘æ··åˆ AHEW = 100 Ã· ${totalEqB.toFixed(4)} = <span style="color:#2563eb"><b>${finalAHEW_B.toFixed(2)}</b></span></div>`;
        } else {
            breakdownHTML += `(ç­‰å¾…æ•¸æ“š...)</div>`;
        }

        // 5. æœ€çµ‚ PHR
        let finalPHR = 0;
        let finalRatio = 0;

        if (finalEEW_A > 0 && finalAHEW_B > 0) {
            const basePHR = (finalAHEW_B / finalEEW_A) * 100;
            finalPHR = basePHR * stoichiometry;
            finalRatio = finalPHR > 0 ? (100 / finalPHR) : 0;

            breakdownHTML += `<div><strong>3. æœ€çµ‚é…æ¯”è¨ˆç®—</strong><br>`;
            breakdownHTML += `ç†è«– PHR = (${finalAHEW_B.toFixed(2)} Ã· ${finalEEW_A.toFixed(2)}) Ã— 100 = <b>${basePHR.toFixed(2)}</b><br>`;
            breakdownHTML += `ä¿®æ­£å¾Œ PHR = ${basePHR.toFixed(2)} Ã— ${stoichiometry} = <span style="color:#dc2626"><b>${finalPHR.toFixed(2)}</b></span></div>`;
        }

        document.getElementById('math-breakdown').innerHTML = breakdownHTML;
        
        document.getElementById('result-phr').textContent = finalPHR > 0 ? `100 : ${finalPHR.toFixed(2)}` : "100 : --";
        document.getElementById('result-ratio').textContent = finalRatio > 0 ? `${finalRatio.toFixed(1)} : 1` : "-- : 1";

        // 6. æ›´æ–°å°ˆå®¶å»ºè­°
        updateExpertAdvice(solidEEWSum, totalResinWt, ahewSum, totalHardenerWt);
    }

    function updateExpertAdvice(wSolidEEW, totalResinWt, wAHEW, totalHardenerWt) {
        const avgSolidEEW = totalResinWt > 0 ? (wSolidEEW / totalResinWt) : 0;
        const avgAHEW = totalHardenerWt > 0 ? (wAHEW / totalHardenerWt) : 0;
        const contentDiv = document.getElementById('expert-advice-content');

        if (avgSolidEEW === 0 || avgAHEW === 0) {
            contentDiv.innerHTML = "è«‹è¼¸å…¥å®Œæ•´æ¨¹è„‚èˆ‡ç¡¬åŒ–åŠ‘æ•¸æ“šä»¥å–å¾—åˆ†æå ±å‘Š...";
            return;
        }

        let resinAnalysis = "";
        let hardenerAnalysis = "";

        if (avgSolidEEW < 300) {
            resinAnalysis = `âš ï¸ <b>é«˜äº¤è¯å¯†åº¦ (Liquid Rich):</b><br> å¹³å‡å›ºé«” EEW (${avgSolidEEW.toFixed(0)}) åä½ã€‚<br>â€¢ å„ªé»ï¼šç¡¬åº¦æ¥µé«˜ã€é˜²è…æ€§ä½³ã€‚<br>â€¢ ç¼ºé»ï¼š<b>ä¹¾ç‡¥æ…¢</b>ï¼Œæ‰“ç£¨é›£ï¼Œæ¼†è†œè¼ƒè„†ã€‚`;
        } else if (avgSolidEEW >= 300 && avgSolidEEW <= 650) {
            resinAnalysis = `âœ… <b>æ¨™æº–åº•æ¼†å‹ (Solid Type 1):</b><br> å¹³å‡å›ºé«” EEW (${avgSolidEEW.toFixed(0)}) è™•æ–¼é»ƒé‡‘å€é–“ã€‚<br>â€¢ ç‰¹æ€§ï¼šå…·å‚™è‰¯å¥½çš„<b>ç‰©ç†ä¹¾ç‡¥</b>ï¼Œåˆ©æ–¼å¿«é€Ÿæ‰“ç£¨ã€‚`;
        } else {
            resinAnalysis = `â„¹ï¸ <b>é«˜åˆ†å­é‡å‹ (High MW):</b><br> å¹³å‡å›ºé«” EEW (${avgSolidEEW.toFixed(0)}) é«˜ã€‚<br>â€¢ ç‰¹æ€§ï¼šä¹¾ç‡¥æ¥µå¿«ï¼ŒæŸ”éŸŒæ€§å¥½ï¼Œä½†è€æº¶åŠ‘æ€§è¼ƒå¼±ã€‚`;
        }

        if (avgAHEW < 100) {
            hardenerAnalysis = `âš ï¸ <b>é«˜æ´»æ€§ç¡¬åŒ–åŠ‘:</b><br> AHEW (${avgAHEW.toFixed(0)}) ä½ã€‚<br>â€¢ æ³¨æ„ï¼šåæ‡‰æ¥µå¿«ï¼Œ<b>æ´»åŒ–æœŸ (Pot Life) çŸ­</b>ï¼Œéœ€æ³¨æ„æ–½å·¥æ™‚é–“ã€‚`;
        } else if (avgAHEW >= 100 && avgAHEW <= 250) {
            hardenerAnalysis = `âœ… <b>æ¨™æº–å‹ç¡¬åŒ–åŠ‘:</b><br> AHEW (${avgAHEW.toFixed(0)}) é©ä¸­ã€‚<br>â€¢ ç‰¹æ€§ï¼šæ´»åŒ–æœŸç´„ 3-6 å°æ™‚ï¼Œå¯†è‘—æ€§ä½³ã€‚`;
        } else {
            hardenerAnalysis = `â„¹ï¸ <b>ä½åæ‡‰æ€§ç¡¬åŒ–åŠ‘:</b><br> AHEW (${avgAHEW.toFixed(0)}) é«˜ã€‚<br>â€¢ æ³¨æ„ï¼šæ´»åŒ–æœŸé•·ï¼Œä½†ä¹¾ç‡¥æ…¢ï¼Œé€šå¸¸éœ€çƒ˜çƒ¤ã€‚`;
        }

        contentDiv.innerHTML = `
            <div style="margin-bottom:15px;">
                <span class="expert-label">ã€æ¨¹è„‚ç³»çµ±åˆ†æã€‘</span>
                ${resinAnalysis}
            </div>
            <div style="margin-bottom:15px;">
                <span class="expert-label">ã€ç¡¬åŒ–åŠ‘ç³»çµ±åˆ†æã€‘</span>
                ${hardenerAnalysis}
            </div>
            <div style="font-size: 0.9em; color: #555; background: #fff; padding: 10px; border-radius: 4px;">
                <b>ğŸ’¡ åƒæ•¸èªªæ˜ï¼š</b><br>
                â€¢ <b>EEW (ç’°æ°§ç•¶é‡):</b> è¶Šå° = è¶Šç¡¬ã€è¶Šæ…¢ä¹¾ã€‚<br>
                â€¢ <b>AHEW (æ´»æ½‘æ°«ç•¶é‡):</b> è¶Šå° = åæ‡‰è¶Šå¿«ã€æ™‚é–“è¶ŠçŸ­ã€‚<br>
                â€¢ <b>è¨ˆé‡æ¯”:</b> >1.0 (èƒºéé‡) å¯åŠ å¿«åæ‡‰èˆ‡é™„è‘—ã€‚
            </div>
        `;
    }
</script>

</body>
</html>